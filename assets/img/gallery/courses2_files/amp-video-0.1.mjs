;
(self.AMP=self.AMP||[]).push({m:1,v:"2401122240000",n:"amp-video",ev:"0.1",l:!0,f:function(t,i){(()=>{var i;function n(){return i||(i=Promise.resolve(void 0))}var e=class{constructor(){this.promise=new Promise(((t,i)=>{this.resolve=t,this.reject=i}))}};function s(t){return new Promise((i=>{i(t())}))}function r(t){return t?Array.prototype.slice.call(t):[]}var{isArray:o}=Array;function c(t){return o(t)?t:[t]}var{hasOwnProperty:a,toString:h}=Object.prototype;function u(t){const i=Object.create(null);return t&&Object.assign(i,t),i}function l(t){return"number"==typeof t&&isFinite(t)}function d(t,i,n,e,s,r,o,c,a,h,u){return t}function f(t){return JSON.parse(t)}function p(t){return(t.ownerDocument||t).defaultView}function m(t,i){return t.replace(/^|,/g,`$&${i} `)}function v(t){d(/^[\w-]+$/.test(t))}function _(t,i){return t.matches(i)}function g(t,i){for(let n=t.firstElementChild;n;n=n.nextElementSibling)if(i(n))return n;return null}function P(t,i){return v(i),n=`> ${i}`,t.querySelectorAll(m(n,":scope"));var n}var A,b,y={bubbles:!0,cancelable:!0};function M(t){var i;null===(i=t.parentElement)||void 0===i||i.removeChild(t)}function E(t,i,n=null){if(!n)return void function(t,i){t.insertBefore(i,t.firstChild)}(t,i);const e=n.nextSibling;t.insertBefore(i,e)}function R(t,i){for(const n in i)t.setAttribute(n,i[n]);return t}function T(t,i,n,e){const s=n||{};d(t.ownerDocument);const{bubbles:r,cancelable:o}=e||y,c=new MessageEvent(i,{data:s,bubbles:r,cancelable:o});t.dispatchEvent(c)}function I(t,i){t.classList.add("i-amphtml-fill-content"),i&&t.classList.add("i-amphtml-replaced-content")}function V(t,i,n,e){const s=c(t);for(const t of s){const s=i.getAttribute(t);null!==s?n.setAttribute(t,s):e&&n.removeAttribute(t)}}function w(t){const i=t.ownerDocument||t;return A&&A.ownerDocument===i||(A=i.createElement("div")),k}function k(t){return function(t,i){if(d(1===i.length),d(Array.isArray(i)||(n=i,a.call(n,"raw"))),self.trustedTypes&&self.trustedTypes.createPolicy){const n=self.trustedTypes.createPolicy("static-template#createNode",{createHTML:function(t){return i[0]}});t.innerHTML=n.createHTML("ignored")}else t.innerHTML=i[0];var n;const e=t.firstElementChild;return d(e),d(!e.nextElementSibling),t.removeChild(e),e}(A,t)}function S(t){const i=Object.getOwnPropertyDescriptor(t,"message");if(null!=i&&i.writable)return t;const{message:n,stack:e}=t,s=new Error(n);for(const i in t)s[i]=t[i];return s.stack=e,s}function C(t){let i=null,n="";for(const t of arguments)t instanceof Error&&!i?i=S(t):(n&&(n+=" "),n+=t);return i?n&&(i.message=n+": "+i.message):i=new Error(n),i}function O(t){var i,n;null===(i=(n=self).__AMP_REPORT_ERROR)||void 0===i||i.call(n,t)}function x(t,...i){try{return t.apply(null,i)}catch(t){!function(t){const i=C.apply(null,arguments);setTimeout((()=>{throw O(i),i}))}(t)}}function j(t){const i=C.apply(null,arguments);return i.expected=!0,i}function q(t,...i){O(j.apply(null,i))}var $=["Webkit","webkit","Moz","moz","ms","O","o"],F={"getPropertyPriority":()=>"","getPropertyValue":()=>""};function L(t){const i=t.replace(/[A-Z]/g,(t=>"-"+t.toLowerCase()));return $.some((t=>i.startsWith(t+"-")))?`-${i}`:i}function z(t,i,n){if(i.startsWith("--"))return i;b||(b=u());let e=b[i];if(!e||n){if(e=i,void 0===t[i]){const n=function(t){return t.charAt(0).toUpperCase()+t.slice(1)}(i),s=function(t,i){for(let n=0;n<$.length;n++){const e=$[n]+i;if(void 0!==t[e])return e}return""}(t,n);void 0!==t[s]&&(e=s)}n||(b[i]=e)}return e}function U(t,i,n,e,s){const r=z(t.style,i,s);if(!r)return;const o=e?n+e:n;t.style.setProperty(L(r),o)}function B(t,i){for(const n in i)U(t,n,i[n])}function N(t){return null==t.__AMP_AUTOPLAY&&(t.__AMP_AUTOPLAY=function(t){const i=t.document.createElement("video");var n;return i.setAttribute("muted",""),i.setAttribute("playsinline",""),i.setAttribute("webkit-playsinline",""),i.setAttribute("height","0"),i.setAttribute("width","0"),i.muted=!0,i.playsInline=!0,i.playsinline=!0,i.webkitPlaysinline=!0,B(i,{position:"fixed",top:"0",width:"0",height:"0",opacity:"0"}),n=i,s((()=>n.play())).catch((()=>{})),Promise.resolve(!i.paused)}(t)),t.__AMP_AUTOPLAY}function D(t){return t.querySelector("video, iframe")}function Y(t,i){const n=s((()=>t.play(!!i)));return n.catch((t=>{q(0,t)})),n}var W=/vertical/,H=new WeakMap,J=new WeakMap,G=new WeakMap;function X(t){let i=H.get(t);return i||(i=new t.ResizeObserver(Z),H.set(t,i)),i}function Z(t){const i=new Set;for(let n=t.length-1;n>=0;n--){const e=t[n],{target:s}=e;if(i.has(s))continue;i.add(s);const r=J.get(s);if(r){G.set(s,e);for(let t=0;t<r.length;t++){const{callback:i,type:n}=r[t];K(n,i,e)}}}}function K(t,i,n){if(0==t){const{contentRect:t}=n,{height:e,width:s}=t;x(i,{width:s,height:e})}else if(1==t){const{borderBoxSize:t}=n;let e;if(t)e=t.length>0?t[0]:{inlineSize:0,blockSize:0};else{const{target:t}=n,i=p(t),s=W.test(function(t,i){return t.getComputedStyle(i)||F}(i,t).writingMode),{offsetHeight:r,offsetWidth:o}=t;let c,a;s?(a=o,c=r):(c=o,a=r),e={inlineSize:c,blockSize:a}}x(i,e)}}function Q(t,i,n){return i in t?Object.defineProperty(t,i,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[i]=n,t}function tt(t,i){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var e=Object.getOwnPropertySymbols(t);i&&(e=e.filter((function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable}))),n.push.apply(n,e)}return n}function it(t){for(var i=1;i<arguments.length;i++){var n=null!=arguments[i]?arguments[i]:{};i%2?tt(Object(n),!0).forEach((function(i){Q(t,i,n[i])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):tt(Object(n)).forEach((function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(n,i))}))}return t}var nt=/(?:^[#?]?|&)([^=&]+)(?:=([^&]*))?/g;function et(t,i=""){try{return decodeURIComponent(t)}catch(t){return i}}function st(t){let i=!1,n=null,e=t;return(...t)=>(i||(n=e.apply(self,t),i=!0,e=null),n)}self.__AMP_LOG=self.__AMP_LOG||{user:null,dev:null,userForEmbed:null};var rt=self.__AMP_LOG;function ot(t){return rt.user||(rt.user=ct()),function(t,i){return i&&i.ownerDocument.defaultView!=t}(rt.user.win,t)?rt.userForEmbed||(rt.userForEmbed=ct()):rt.user}function ct(t){return function(t,i){throw new Error("failed to call initLogConstructor")}()}function at(t,i,n,e,s,r,o,c,a,h,u){return t}function ht(t,i,n,e,s,r,o,c,a,h,u){return ot().assert(t,i,n,e,s,r,o,c,a,h,u)}function ut(t,i){return mt(t=function(t){return t.__AMP_TOP||(t.__AMP_TOP=t)}(t),i)}function lt(t,i){return mt(pt(ft(t)),i)}function dt(t,i){const n=pt(ft(t));return _t(n,i)?mt(n,i):null}function ft(t){return t.nodeType?(i=p(t),ut(i,"ampdoc")).getAmpDoc(t):t;var i}function pt(t){const i=ft(t);return i.isSingleDoc()?i.win:i}function mt(t,i){at(_t(t,i));const n=vt(t)[i];return n.obj||(at(n.ctor),at(n.context),n.obj=new n.ctor(n.context),at(n.obj),n.context=null,n.resolve&&n.resolve(n.obj)),n.obj}function vt(t){let i=t.__AMP_SERVICES;return i||(i=t.__AMP_SERVICES={}),i}function _t(t,i){const n=t.__AMP_SERVICES&&t.__AMP_SERVICES[i];return!(!n||!n.ctor)}var gt="__AMP__EXPERIMENT_TOGGLES";function Pt(t,i){const n=function(t){var i,n,e,s,r;if(t[gt])return t[gt];t[gt]=u();const c=t[gt];d(c);const a=it(it({},null!==(i=t.AMP_CONFIG)&&void 0!==i?i:{}),null!==(n=t.AMP_EXP)&&void 0!==n?n:f((null===(e=t.__AMP_EXP)||void 0===e?void 0:e.textContent)||"{}"));for(const t in a){const i=a[t];"number"==typeof i&&i>=0&&i<=1&&(c[t]=Math.random()<i)}const h=null===(s=t.AMP_CONFIG)||void 0===s?void 0:s["allow-doc-opt-in"];if(o(h)&&h.length){const i=t.document.head.querySelector('meta[name="amp-experiments-opt-in"]');if(i){var l;const t=(null===(l=i.getAttribute("content"))||void 0===l?void 0:l.split(","))||[];for(const i of t)h.includes(i)&&(c[i]=!0)}}Object.assign(c,function(t){var i;let n="";try{var e;"localStorage"in t&&(n=null!==(e=t.localStorage.getItem("amp-experiment-toggles"))&&void 0!==e?e:"")}catch(t){}const s=(null===(i=n)||void 0===i?void 0:i.split(/\s*,\s*/g))||[],r=u();for(const t of s)t&&("-"==t[0]?r[t.substr(1)]=!1:r[t]=!0);return r}(t));const p=null===(r=t.AMP_CONFIG)||void 0===r?void 0:r["allow-url-opt-in"];if(o(p)&&p.length){const i=function(t){const i=u();if(!t)return i;let n;for(;n=nt.exec(t);){const t=et(n[1],n[1]),e=n[2]?et(n[2].replace(/\+/g," "),n[2]):"";i[t]=e}return i}(t.location.originalHash||t.location.hash);for(const t of p){const n=i[`e-${t}`];"1"==n&&(c[t]=!0),"0"==n&&(c[t]=!1)}}return c}(t);return!!n[i]}var At,bt,yt,Mt=t=>dt(t,"action"),Et=t=>ut(t,"extensions"),Rt=t=>ut(t,"performance"),Tt=t=>ut(t,"platform"),It=t=>mt(t,"timer"),Vt=t=>dt(t,"url"),wt=t=>lt(t,"viewport");function kt(t,i,n={}){const{needsRootBounds:e,rootMargin:s,threshold:r}=n,o=function(t){return t.parent&&t.parent!=t}(i)&&(e||s)?i.document:void 0;return new i.IntersectionObserver(t,{threshold:r,root:o,rootMargin:s})}function St(t){var i;let n=null===(i=At)||void 0===i?void 0:i.get(t);if(!n){const i=function(t){At||(At=new WeakMap,bt=new WeakMap),d(bt);let i=bt.get(t);return i||(i=kt((t=>{const n=new Set;for(let s=t.length-1;s>=0;s--){var e;const{target:r}=t[s];n.has(r)||(n.add(r),d(i),i.unobserve(r),d(At),null===(e=At.get(r))||void 0===e||e.resolve(t[s]),At.delete(r))}}),t,{needsRootBounds:!0}),bt.set(t,i)),i}(p(t));d(At),i.observe(t),n=new e,At.set(t,n)}return n.promise}function Ct(t,i,n,e){let s=t,r=n,o=t=>{try{return r(t)}catch(t){var i,n;throw null===(i=(n=self).__AMP_REPORT_ERROR)||void 0===i||i.call(n,t),t}};const c=function(){if(void 0!==yt)return yt;yt=!1;try{const t={get capture(){return yt=!0,!1}};self.addEventListener("test-options",null,t),self.removeEventListener("test-options",null,t)}catch(t){}return yt}(),a=!(null==e||!e.capture);return s.addEventListener(i,o,c?e:a),()=>{null==s||s.removeEventListener(i,o,c?e:a),r=null,s=null,o=null}}function Ot(t,i,n,e){const s={detail:n};return Object.assign(s,e),new t.CustomEvent(i,s)}function xt(t,i,n,e){return Ct(t,i,n,e)}function jt(t,i,n,e){let s=n;const r=Ct(t,i,(t=>{try{s(t)}finally{s=null,r()}}),e);return r}var qt=['<button aria-label="Unmute video" class="i-amphtml-video-mask i-amphtml-fill-content" tabindex=0></button>'],$t=["<i-amphtml-video-icon class=amp-video-eq><div class=amp-video-eq-col><div class=amp-video-eq-filler></div><div class=amp-video-eq-filler></div></div></i-amphtml-video-icon>"];function Ft(t,i,n){if(i[n])return i[n];const e=t.querySelector(`style[${n}], link[${n}]`);return e?(i[n]=e,e):null}function Lt(t,i){const n=t.styleSheets;for(let t=0;t<n.length;t++)if(n[t].ownerNode==i)return!0;return!1}var zt=class{constructor(){this.Mv=!1,this.Rv=new class{constructor(){this.At=null}add(t){return this.At||(this.At=[]),this.At.push(t),()=>{this.remove(t)}}remove(t){this.At&&function(t,i){const n=t.indexOf(i);-1!=n&&t.splice(n,1)}(this.At,t)}removeAll(){this.At&&(this.At.length=0)}fire(t){if(this.At)for(const i of this.At.slice())i(t)}getHandlerCount(){var t,i;return null!==(t=null===(i=this.At)||void 0===i?void 0:i.length)&&void 0!==t?t:0}}}onSessionEnd(t){this.Rv.add(t)}beginSession(){this.Mv=!0}endSession(){this.Mv&&this.Rv.fire(),this.Mv=!1}isSessionActive(){return this.Mv}},Ut={"title":"","artist":"","album":"","artwork":[{"src":""}]},Bt="registered",Nt="load",Dt="loadedmetadata",Yt="play",Wt="playing",Ht="pause",Jt="ended",Gt="muted",Xt="unmuted",Zt="reloaded",Kt="ad_start",Qt="ad_end",ti="playing_manual",ii="paused",ni="video-play",ei="user-interacted";function si(t){t.signals().signal(ei)}var ri="video-manager",oi=(t,i)=>!!t&&(t.video===i||t.video.element===i);function ci(t,i){const n=i.top+i.height/2,e=t.getSize().height/2;return Math.abs(n-e)}function ai(t){return 10*t*5}var hi=t=>!!t&&!isNaN(t)&&t>1;function ui(t,i,n){const{video:e}=t;t.getAnalyticsDetails().then((t=>{n&&Object.assign(t,n),T(e.element,i,t)}))}function li(t){!function(t,i,e,s){const r=ft(t),c=pt(r);!function(t,i,n,e,s,r){const o=vt(t);let c=o[n];c||(c=o[n]={obj:null,promise:null,resolve:null,reject:null,context:null,ctor:null,sharedInstance:!1}),c.ctor||(c.ctor=e,c.context=i,c.sharedInstance=!1,c.resolve&&mt(t,n))}(c,r,i,class{constructor(t){this.ampdoc=t,this.installAutoplayStyles=st((()=>function(t){!function(t,i,n,e,s){const r=t.getHeadNode(),o=function(t,i,n,e){let s=t.__AMP_CSS_SM;s||(s=t.__AMP_CSS_SM=u());const r=!n&&e&&"amp-custom"!=e&&"amp-keyframes"!=e,o=n?"amp-runtime":r?`amp-extension=${e}`:null;if(o){const n=Ft(t,s,o);if(n)return"STYLE"==n.tagName&&n.textContent!==i&&(n.textContent=i),n}const c=(t.ownerDocument||t).createElement("style");c.textContent=i;let a=null;return n?c.setAttribute("amp-runtime",""):r?(c.setAttribute("amp-extension",e||""),a=Ft(t,s,"amp-runtime")):(e&&c.setAttribute(e,""),a=t.lastChild),E(t,c,a),o&&(s[o]=c),c}(r,function(t,i){const n=t.__AMP_CSS_TR;return n?n(i):i}(r,i),e||!1,s||null);if(n){const i=t.getRootNode();if(Lt(i,o))return n(o),o;const e=setInterval((()=>{Lt(i,o)&&(clearInterval(e),n(o))}),4)}}(t,".i-amphtml-video-mask{display:block;z-index:1;-webkit-appearance:none;appearance:none;background:transparent;border:none}.amp-video-eq{display:none}.i-amphtml-video-interface:not(amp-video) .amp-video-eq,amp-story .amp-video-eq,amp-video[controls] .amp-video-eq{display:-ms-flexbox;display:flex}[noaudio] .amp-video-eq{display:none!important}.amp-video-eq{pointer-events:none!important;-ms-flex-align:end;align-items:flex-end;bottom:7px;height:12px;opacity:0.8;overflow:hidden;position:absolute;right:7px;width:20px;z-index:1}.amp-video-eq-col{-ms-flex:1;flex:1;height:100%;margin-right:1px;position:relative}.amp-video-eq-col div{animation-name:amp-video-eq-animation;animation-timing-function:linear;animation-iteration-count:infinite;animation-direction:alternate;background-color:#fafafa;height:100%;position:absolute;width:100%;will-change:transform;animation-play-state:paused}.amp-video-eq-play .amp-video-eq-col div{animation-play-state:running}.amp-video-eq-1-1{animation-duration:0.3s;transform:translateY(60%)}.amp-video-eq-1-2{animation-duration:0.45s;transform:translateY(60%)}.amp-video-eq-2-1{animation-duration:0.5s;transform:translateY(30%)}.amp-video-eq-2-2{animation-duration:0.4s;transform:translateY(30%)}.amp-video-eq-3-1{animation-duration:0.3s;transform:translateY(70%)}.amp-video-eq-3-2{animation-duration:0.35s;transform:translateY(70%)}.amp-video-eq-4-1{animation-duration:0.4s;transform:translateY(50%)}.amp-video-eq-4-2{animation-duration:0.25s;transform:translateY(50%)}@keyframes amp-video-eq-animation{0%{transform:translateY(100%)}to{transform:translateY(0)}}\n/*# sourceURL=/css/video-autoplay.css*/",null,!1,"amp-video-autoplay")}(this.ampdoc))),this.Tv=null,this.Vv=null,this.qv=null,this.er=It(t.win),this.Ov=Mt(t.getHeadNode()),this.$v=()=>this.Fv(),this.jv=st((()=>new class{constructor(t,i){this.Uv=i,this.ji=t,this.Yv=null,this.Nv=null,this.Tv=[],this.__=[],this.Dv=()=>this.Lv(),this.Bv=t=>this.Wv(t)==ti,this.Jv=(t,i)=>this.Hv(t,i),this.Zv(),this.Gv()}dispose(){this.__.forEach((t=>t())),this.__.length=0}register(t){const{video:i}=t,{element:n}=i;this.Kv(n)&&(this.Tv.push(i),xt(n,Ht,this.Dv),xt(n,Wt,this.Dv),xt(n,Jt,this.Dv),i.signals().whenSignal(ei).then(this.Dv),this.Lv())}Gv(){const t=this.ji.getRootNode(),i=()=>this.Qv();this.__.push(xt(t,"webkitfullscreenchange",i),xt(t,"mozfullscreenchange",i),xt(t,"fullscreenchange",i),xt(t,"MSFullscreenChange",i))}isInLandscape(){return(t=this.ji.win).screen&&"orientation"in t.screen?t.screen.orientation.type.startsWith("landscape"):90==Math.abs(t.orientation);var t}Kv(t){if("video"==D(t).tagName.toLowerCase())return!0;const i=Tt(this.ji.win);return!i.isIos()&&!i.isSafari()||function(t){return!!{"amp-dailymotion":!0,"amp-ima-video":!0}[t.tagName.toLowerCase()]}(t)}Qv(){this.Yv=null}Zv(){const{win:t}=this.ji,{screen:i}=t;if(i&&"orientation"in i){const t=i.orientation;this.__.push(xt(t,"change",(()=>this.Xv())))}this.__.push(xt(t,"orientationchange",(()=>this.Xv())))}Xv(){this.isInLandscape()?null!=this.Nv&&this.Rg(this.Nv):this.Yv&&this.Vg(this.Yv)}Rg(t){const i=Tt(this.ji.win);this.Yv=t,i.isAndroid()&&i.isChrome()?t.fullscreenEnter():this.kg(t).then((()=>t.fullscreenEnter()))}Vg(t){this.Yv=null,this.kg(t,"center").then((()=>t.fullscreenExit()))}kg(t,i=null){const{element:e}=t,s=this.Cg();return this.xg().then((()=>St(e))).then((({boundingClientRect:t})=>{const{bottom:r,top:o}=t,c=s.getSize().height;if(o>=0&&r<=c)return n();const a=i||(r>c?"bottom":"top");return s.animateScrollIntoView(e,a)}))}Cg(){return wt(this.ji)}xg(){return It(this.ji.win).promise(330)}Lv(){if(this.isInLandscape())return Promise.resolve(this.Nv);this.Nv=null;const t=this.Tv.filter(this.Bv).map((t=>St(t.element)));return Promise.all(t).then((t=>{const i=t.sort(this.Jv)[0];return i&&i.intersectionRatio>.5?i.target.getImpl().then((t=>this.Nv=t)):this.Nv}))}Hv(t,i){const{boundingClientRect:n,intersectionRatio:e}=t,{boundingClientRect:s,intersectionRatio:r}=i,o=e-r;if(Math.abs(o)>.1)return o;const c=wt(this.ji),a=ci(c,n),h=ci(c,s);return a<h||a>h?a-h:n.top-s.top}Wv(t){return this.Uv.getPlayingState(t)}}(this.ampdoc,this))),this.er.delay(this.$v,1e3)}dispose(){if(this.jv().dispose(),this.Vv.disconnect(),this.Vv=null,this.Tv)for(let t=0;t<this.Tv.length;t++)this.Tv[t].dispose()}Fv(){for(let t=0;t<this.Tv.length;t++){const i=this.Tv[t];i.getPlayingState()!==ii&&(ui(i,"video-seconds-played"),this.qg(i))}this.er.delay(this.$v,1e3)}qg(t){const i="timeUpdate",n=t.video.getCurrentTime(),e=t.video.getDuration();if(l(n)&&l(e)&&e>0){const s=n/e,r=Ot(this.ampdoc.win,`${ri}.${i}`,{"time":n,"percent":s});this.Ov.trigger(t.video.element,i,r,1)}}register(t){at(t);const i=t;if(this.$g(t),!t.supportsPlatform())return;if(this.Fg(t))return;if(!this.Vv){const t=t=>t.forEach((({isIntersecting:t,target:i})=>{this.Ug(i).updateVisibility(t)}));this.Vv=kt(t,this.ampdoc.win,{threshold:.5})}this.Vv.observe(i.element),xt(i.element,Zt,(()=>n.videoLoaded())),this.Tv=this.Tv||[];const n=new class{constructor(t,i){this.Uv=t,this.ji=t.ampdoc,this.video=i,this.Yg=!0,this.zg=!1,this.zv=!1,this.Ng=!1,this.ps=!1,this.Dg=new zt,this.Dg.onSessionEnd((()=>ui(this,"video-session"))),this.Lg=new zt,this.Lg.onSessionEnd((()=>ui(this,"video-session-visible"))),this.Bg=st((()=>new class{constructor(t,i){this.er=It(t),this.Wg=i,this.__=null,this.Jg=0,this.Hg=0}start(){const{element:t}=this.Wg.video;this.stop(),this.__=this.__||[],this.Zg()?this.Gg(this.Hg):this.__.push(jt(t,Dt,(()=>{this.Zg()&&this.Gg(this.Hg)}))),this.__.push(xt(t,Jt,(()=>{this.Zg()&&this.Kg(100)})))}stop(){if(this.__){for(;this.__.length>0;)this.__.pop()();this.Hg++}}Zg(){const{video:t}=this.Wg,i=t.getDuration();if(!hi(i))return!1;if(ai(i)<250){const i=Math.ceil(5);this.Qg("This video is too short for `video-percentage-played`. Reports may be innacurate. For best results, use videos over",i,"seconds long.",t.element)}return!0}Qg(...t){ot().warn.apply(ot(),[ri].concat(t))}Gg(t){if(t!=this.Hg)return;const{Wg:i,er:n}=this,{video:e}=i,s=()=>this.Gg(t);if(i.getPlayingState()==ii)return void n.delay(s,500);const r=e.getDuration();if(!hi(r))return void n.delay(s,500);const o=(h=ai(r),d(!0),Math.min(Math.max(h,250),4e3)),c=e.getCurrentTime()/r*100,a=5*Math.floor(c/5);var h;at(l(a)),this.Kg(a),n.delay(s,o)}Kg(t){t<=0||this.Jg!=t&&(this.Jg=t,this.Xg(t))}Xg(t){ui(this.Wg,"video-percentage-played",{"normalizedPercentage":t.toString()})}}(this.ji.win,this))),this.Ay=!1,this.by=!1,this.My=null,this.B=!1,this.wy=!1,this.hasAutoplay=i.element.hasAttribute("autoplay"),this.hasAutoplay&&this.Uv.installAutoplayStyles(),this.Ey=Ut,this.Iy=()=>{Y(this.video,!1)},this.Ry=()=>{this.video.pause()},xt(i.element,Nt,(()=>this.videoLoaded())),xt(i.element,Ht,(()=>this.Ty())),xt(i.element,Yt,(()=>{this.wy=!0,ui(this,ni)})),xt(i.element,Wt,(()=>this.Vy())),xt(i.element,Gt,(()=>this.B=!0)),xt(i.element,Xt,(()=>{this.B=!1,this.Uv.pauseOtherVideos(this)})),xt(i.element,"amp:video:tick",(t=>{const i=t.data,n=i.eventType;n&&this.ky(n,i.vars)})),xt(i.element,Jt,(()=>{this.Ng=!1,ui(this,"video-ended")})),xt(i.element,Kt,(()=>{this.Ng=!0,ui(this,"video-ad-start")})),xt(i.element,Qt,(()=>{this.Ng=!1,ui(this,"video-ad-end")})),i.signals().whenSignal(Bt).then((()=>this.Cy())),this.Sy=st((()=>{const t="firstPlay",i=Ot(this.ji.win,t,{}),{element:n}=this.video;Mt(n).trigger(n,t,i,1)})),this.xy()}dispose(){this.Bg().stop()}ky(t,i){const n={"__amp:eventType":t};Object.keys(i).forEach((t=>{n[`custom_${t}`]=i[t]})),ui(this,"video-hosted-custom",n)}xy(){this.video.signals().whenSignal("playback-delegated").then((()=>{this.Yg=!1,this.zv&&this.video.pause()}))}isMuted(){return this.B}isPlaybackManaged(){return this.Yg}Cy(){this.qy()&&this.Uv.registerForAutoFullscreen(this),this.hasAutoplay&&this.Oy()}qy(){const{element:t}=this.video;return!(this.video.preimplementsAutoFullscreen()||!t.hasAttribute("rotate-to-fullscreen"))&&ht(this.video.isInteractive(),"Only interactive videos are allowed to enter fullscreen on rotate. Set the `controls` attribute on %s to enable.",t)}Vy(){this.zv=!0,this.getPlayingState()==ti&&(this.Sy(),this.Uv.pauseOtherVideos(this));const{video:t}=this,{element:i}=t;t.preimplementsMediaSessionAPI()||i.classList.contains("i-amphtml-disable-mediasession")||(function(t,i){const n=Vt(t);if(i&&i.artwork){const{artwork:t}=i;at(o(t)),t.forEach((t=>{if(t){const e=(i=t,"[object Object]"===h.call(i)?t.src:t);ht(n.isProtocolValid(e))}var i}))}}(i,this.Ey),function(t,i,n,e){const{navigator:s}=t;"mediaSession"in s&&t.MediaMetadata&&(s.mediaSession.metadata=new t.MediaMetadata(Ut),s.mediaSession.metadata=new t.MediaMetadata(i),s.mediaSession.setActionHandler("play",n),s.mediaSession.setActionHandler("pause",e))}(this.ji.win,this.Ey,this.Iy,this.Ry)),this.Dg.beginSession(),this.ps&&this.Lg.beginSession(),this.wy||ui(this,ni)}Ty(){ui(this,"video-pause"),this.zv=!1,this.by?this.by=!1:this.Dg.endSession()}videoLoaded(){this.zg=!0,this.My=D(this.video.element),this.$y(),this.Bg().start(),this.ps&&this.Fy()}$y(){if(this.video.preimplementsMediaSessionAPI())return;this.video.getMetadata()&&(this.Ey=u(this.video.getMetadata()));const t=this.ji.win.document;if(!this.Ey.artwork||0==this.Ey.artwork.length){const i=function(t){const i=t.querySelector('script[type="application/ld+json"]');if(!i)return;const n=function(t,i){try{return f(t)}catch(t){return null}}(i.textContent);return n&&n.image?"string"==typeof n.image?n.image:n.image["@list"]&&"string"==typeof n.image["@list"][0]?n.image["@list"][0]:"string"==typeof n.image.url?n.image.url:"string"==typeof n.image[0]?n.image[0]:void 0:void 0}(t)||function(t){const i=t.querySelector('meta[property="og:image"]');return i?i.getAttribute("content"):void 0}(t)||function(t){const i=t.querySelector('link[rel="shortcut icon"]')||t.querySelector('link[rel="icon"]');return i?i.getAttribute("href"):void 0}(t);i&&(this.Ey.artwork=[{"src":i}])}if(!this.Ey.title){const i=this.video.element.getAttribute("title")||this.video.element.getAttribute("aria-label")||this.My.getAttribute("title")||this.My.getAttribute("aria-label")||t.title;i&&(this.Ey.title=i)}}jy(){this.zg&&this.Fy()}Fy(){this.ji.isVisible()&&N(this.ji.win).then((t=>{this.hasAutoplay&&!this.userInteracted()&&t?this.Uy():this.Yy()}))}Oy(){this.video.isInteractive()&&this.video.hideControls(),N(this.ji.win).then((t=>{t||!this.video.isInteractive()?(this.video.mute(),this.zy()):this.video.showControls()}))}zy(){const{video:t}=this,{element:i,win:n}=this.video;if(i.hasAttribute("noaudio")||i.signals().get(ei))return;const e=function(t,i){const n=w(i)($t),e=n.firstElementChild;for(let t=0;t<4;t++){const i=e.cloneNode(!0),s=i.children;for(let i=0;i<s.length;i++)s[i].classList.add(`amp-video-eq-${t+1}-${i+1}`);n.appendChild(i)}return M(e),n}(0,i),s=[e];function r(i){t.mutateElementSkipRemeasure((()=>{s.forEach((t=>{!function(t,i){void 0===i&&(i=t.hasAttribute("hidden")),i?t.removeAttribute("hidden"):t.setAttribute("hidden","")}(t,i)}))}))}function o(i){t.mutateElementSkipRemeasure((()=>e.classList.toggle("amp-video-eq-play",i)))}const c=[xt(i,Ht,(()=>o(!1))),xt(i,Wt,(()=>o(!0))),xt(i,Kt,(()=>{r(!1),t.showControls()})),xt(i,Qt,(()=>{r(!0),t.hideControls()})),xt(i,Xt,(()=>si(t)))];if(t.isInteractive()){t.hideControls();const n=function(t,i){const n=w(t)(qt);return i&&i.title&&n.setAttribute("aria-label",i.title),n}(i,this.Ey);s.push(n),c.push(xt(n,"click",(()=>si(t))))}t.mutateElementSkipRemeasure((()=>{s.forEach((t=>{i.appendChild(t)}))})),this.Ng&&r(!1),t.signals().whenSignal(ei).then((()=>{this.Sy(),t.isInteractive()&&t.showControls(),t.unmute(),c.forEach((t=>{t()})),t.mutateElementSkipRemeasure((()=>{s.forEach((t=>{M(t)}))}))}))}Uy(){this.Yg&&(this.ps?(this.Lg.beginSession(),Y(this.video,!0),this.Ay=!0):(this.zv&&this.Lg.endSession(),this.video.pause(),this.by=!0))}Yy(){this.ps?this.Lg.beginSession():this.zv&&this.Lg.endSession()}updateVisibility(t){const i=this.ps;this.ps=t,t!=i&&this.jy()}getPlayingState(){return this.zv?this.zv&&this.Ay&&!this.userInteracted()?"playing_auto":ti:ii}isRollingAd(){return this.Ng}userInteracted(){return null!=this.video.signals().get(ei)}getAnalyticsDetails(){const{video:t}=this;return Promise.all([N(this.ji.win),St(t.element)]).then((i=>{const n=i[0],e=i[1],{height:s,width:r}=e.boundingClientRect,o=this.hasAutoplay&&n,c=t.getPlayedRanges(),a=c.reduce(((t,i)=>t+i[1]-i[0]),0);return{"autoplay":o,"currentTime":t.getCurrentTime(),"duration":t.getDuration(),"height":s,"id":t.element.id,"muted":this.B,"playedTotal":a,"playedRangesJson":JSON.stringify(c),"state":this.getPlayingState(),"width":r}}))}}(this,t);this.Tv.push(n);const{element:e}=n.video;T(e,Bt),function(t){t.classList.add("i-amphtml-media-component")}(e),t.signals().signal(Bt),e.classList.add("i-amphtml-video-interface")}$g(t){n("play",(()=>Y(t,!1))),n("pause",(()=>t.pause())),n("mute",(()=>t.mute())),n("unmute",(()=>t.unmute()));const i=()=>t.fullscreenEnter();function n(i,n){t.registerAction(i,(()=>{si(t),n()}),1)}n("fullscreenenter",i),n("fullscreen",i)}Fg(t){if(oi(this.qv,t))return this.qv;for(let i=0;this.Tv&&i<this.Tv.length;i++){const n=this.Tv[i];if(oi(n,t))return this.qv=n,n}return null}Ug(t){return at(this.Fg(t))}registerForAutoFullscreen(t){this.jv().register(t)}Ny(){return this.jv()}getVideoStateProperty(t,i){const e=this.ampdoc.getRootNode(),s=ot().assertElement(e.getElementById(t),`Could not find an element with id="${t}" for VIDEO_STATE`),r=this.Ug(s);return(r?r.getAnalyticsDetails():n()).then((t=>t?t[i]:""))}getPlayingState(t){return this.Ug(t).getPlayingState()}isMuted(t){return this.Ug(t).isMuted()}userInteracted(t){return this.Ug(t).userInteracted()}isRollingAd(t){return this.Ug(t).isRollingAd()}pauseOtherVideos(t){this.Tv.forEach((i=>{i.isPlaybackManaged()&&i!==t&&i.getPlayingState()==ti&&i.video.pause()}))}})}(t,"video-manager")}var di,fi=class t{constructor(t,i){this.win=t,this.vi=i}static make(i,n){if(i.WeakRef)return new i.WeakRef(n);if(!n.id){const t=i.__AMP_WEAKREF_ID=(i.__AMP_WEAKREF_ID||0)+1;n.id="weakref-id-"+t}return new t(i,n.id)}deref(){return this.win.document.getElementById(this.vi)||void 0}},pi={"slow-2g":50,"2g":50,"3g":1e3,"4g":2500,"5g":5e3},mi="i-amphtml-is-video-fully-loaded-override-for-testing";function vi(t,i){return g(t,(t=>"SOURCE"==t.tagName&&i(t)))}function _i(t){if(!t.duration)return 0;let i=0;for(let n=0;n<t.buffered.length;n++)i+=t.buffered.end(n)-t.buffered.start(n);return i/t.duration}function gi(t,i){if(!!i===i||null==i)return;if(Array.isArray(i))return void i.forEach((i=>{gi(t,i)}));const n=i;t.appendChild(n.nodeType?n:self.document.createTextNode(String(i)))}function Pi(t,i,...n){if("string"!=typeof t)return t(it(it({},i),{},{children:n}));const e=null==i?void 0:i.xmlns;e&&delete i.xmlns;const s=e?self.document.createElementNS(e,t):self.document.createElement(t);return gi(s,n),i&&Object.keys(i).forEach((t=>{!function(t,i,n){if(!1!==n&&null!=n)if("function"!=typeof n||"o"!==i[0]||"n"!==i[1])t.setAttribute(i,!0===n?"":String(n));else{const e=i.toLowerCase().substring(2);t.addEventListener(e,n)}}(s,t,i[t])})),s}var Ai;function bi(t,i){return function(t,i,n){if(!i)return t;const e=t.split("#",2),s=e[0].split("?",2);let r=s[0]+(s[1]?`?${s[1]}&${i}`:`?${i}`);return r+=e[1]?`#${e[1]}`:"",r}(t,function(t){const i=[];for(const s in t){let r=t[s];if(null!=r){r=c(r);for(let t=0;t<r.length;t++)i.push((n=s,e=r[t],`${encodeURIComponent(n)}=${encodeURIComponent(e)}`))}}var n,e;return i.join("&")}(i))}var yi=["h264","vp09"];function Mi(t,i,s=Number.POSITIVE_INFINITY){var o;const{win:c}=i;if(Tt(c).isBot())return n();t.hasAttribute("crossorigin")||t.setAttribute("crossorigin","");const a=t.getAttribute("src"),h=null===(o=t.querySelector("source[src]"))||void 0===o?void 0:o.getAttribute("src");return a||h?(Rt(i.win).addEnabledExperiment("video-cache"),function(t,i){const{win:n}=i;if(function(t,i){return t===i.document.querySelector("amp-story-page:first-of-type amp-video")}(t,n)){const t=n.document.getElementById("amp-google-video-cache-response");try{const i=JSON.parse(t.textContent);if(i.sources)return Promise.resolve(i)}catch(t){}}const{canonicalUrl:s,sourceUrl:o}=lt(n.document,"documentInfo").get();!function(t,i){if(!t.hasAttribute("src"))return;const n=i.document.createElement("source"),e=t.getAttribute("src");n.setAttribute("src",e);const s=t.getAttribute("type");s&&n.setAttribute("type",s),t.removeAttribute("src"),t.removeAttribute("type"),t.querySelectorAll("source").forEach(M),t.insertBefore(n,t.firstChild)}(t,n);const c=(h=function(t){var i;const n=r(t.querySelectorAll("source[src]"));for(let t=0;t<n.length;t++)if(_(n[t],'[type*="video/mp4"]'))return n[t].getAttribute("src");return null===(i=n[0])||void 0===i?void 0:i.getAttribute("src")}(t),a=u=o,u="string"==typeof a?function(t,i){return Ai||(Ai=self.document.createElement("a")),function(t,i,n){return t.href="",new URL(i,t.href)}(Ai,t)}(a):a,new URL(h,u.href).toString());var a,h,u;return function(t,i){return Et(i.win).installExtensionForDoc(i,"amp-cache-url").then((()=>function(t,i){return function(t,i){const n=function(t,i){const n=vt(t)[i];return n?n.promise?n.promise:(mt(t,i),n.promise=Promise.resolve(n.obj)):null}(t,i);if(n)return n;const s=vt(t);return s[i]=function(){const t=new e,{promise:i,reject:n,resolve:s}=t;return i.catch((()=>{})),{obj:null,promise:i,resolve:s,reject:n,context:null,ctor:null}}(),s[i].promise}(pt(t),i)}(t,"cache-url")))}(t,i).then((t=>t.createCacheUrl(c))).then((t=>{const i=bi(t.replace(/\/[ic]\//,"/mbv/"),{"amp_video_host_url":s,"amp_video_require_acao_header":1});return(e=n,ut(e,"xhr")).fetch(i,{prerenderSafe:!0}).then((t=>t.json()));var e}))}(t,i).then((i=>{!function(t,i,n){i.sort(((t,i)=>{var n,e;const s=null===(n=t.codec)||void 0===n?void 0:n.split(".")[0],r=null===(e=i.codec)||void 0===e?void 0:e.split(".")[0],o=yi.indexOf(s),c=yi.indexOf(r);if(o>c)return 1;if(o<c)return-1;const a=t.bitrate_kbps,h=i.bitrate_kbps;return a>h?1:a<h?-1:0})).forEach((i=>{if(i.bitrate_kbps>n)return;let e=i.type;i.codec&&"h264"!==i.codec&&(e+="; codecs="+i.codec);const s=(r=t.ownerDocument,o={"src":i.url,type:e,"data-bitrate":i.bitrate_kbps,"i-amphtml-video-cached-source":""},R(r.createElement("source"),o));var r,o;t.insertBefore(s,t.firstChild)}))}(t,i.sources,s),Pt(c,"story-video-cache-apply-audio")&&function(t,i){!1===i&&t.setAttribute("noaudio","")}(t,i.has_audio),function(t,i){if(!i||!i.src||!i.srclang||t.querySelector("track"))return;const n=Pi("track",{src:i.src,srclang:i.srclang,kind:"captions"}),e=Pi("amp-story-captions",{id:i.src,"style-preset":"default",layout:"container","auto-append":!0});t.setAttribute("captions-id",i.src),t.appendChild(n),t.appendChild(e)}(t,i.captions)})).catch((()=>{}))):(ot().error("AMP-VIDEO","Video cache not properly configured"),n())}var Ei=["<i-amphtml-poster></i-amphtml-poster>"],Ri="amp-video",Ti=["aria-describedby","aria-label","aria-labelledby","controls","crossorigin","disableremoteplayback","controlsList","title"],Ii={"high":2e3,"medium":720,"low":400},Vi=["loop","poster","preload"],wi=Ti.concat(Vi),ki=class extends t.BaseElement{static prerenderAllowed(t){if(t.getAttribute("poster")||t.hasAttribute("cache"))return!0;const i=r(P(t,"source"));i.push(t);for(let n=0;n<i.length;n++)if(Si(i[n],t))return!0;return!1}constructor(t){super(t),this.qb=null,this.B=!1,this.Ey=Ut,this.__=[],this.$b=null,this.Fb=null,this.kv=new class{constructor(t){this.yp=t,this.zv=!1,this.Sv=!1,this.Cv=this.Cv.bind(this)}updatePlaying(t){t!==this.zv&&(this.zv=t,t?(this.Sv=!1,function(t,i){!function(t,i,n){const e=t.ownerDocument.defaultView;if(!e)return;let s=J.get(t);if(s||(s=[],J.set(t,s),X(e).observe(t)),!s.some((t=>t.callback===n&&1===t.type))){s.push({type:1,callback:n});const i=G.get(t);i&&setTimeout((()=>K(1,n,i)))}}(t,0,i)}(this.yp,this.Cv)):function(t,i){!function(t,i,n){const e=J.get(t);if(e&&(function(t,i){const e=[];let s=0;for(let i=0;i<t.length;i++){const o=t[i];(r=o).callback===n&&1===r.type?e.push(o):(s<i&&(t[s]=o),s++)}var r;s<t.length&&(t.length=s)}(e),0==e.length)){J.delete(t),G.delete(t);const i=t.ownerDocument.defaultView;i&&X(i).unobserve(t)}}(t,0,i)}(this.yp,this.Cv))}Cv({blockSize:t,inlineSize:i}){const n=i>0&&t>0;if(n===this.Sv)return;this.Sv=n;const e=this.yp;n||e.pause()}}(this.element),this.Lb=!1}preconnectCallback(t){this.Ub().forEach((i=>{var n;(n=this.win,ut(n,"preconnect")).url(this.getAmpDoc(),i,t)}))}Ub(){const t=this.element.getAttribute("src");if(t)return[t];const i=[];return r(P(this.element,"source")).forEach((t=>{const n=t.getAttribute("src");n&&i.push(n);const e=t.getAttribute("amp-orig-src");e&&i.push(e)})),i}isLayoutSupported(t){return function(t){return"fixed"==t||"fixed-height"==t||"responsive"==t||"fill"==t||"flex-item"==t||"fluid"==t||"intrinsic"==t}(t)}buildCallback(){const{element:t}=this;this.Bb(),this.qb=t.ownerDocument.createElement("video");const i=t.getAttribute("poster");var n,e;this.qb.setAttribute("playsinline",""),this.qb.setAttribute("webkit-playsinline",""),this.qb.setAttribute("preload","none"),this.Nb(),V(Ti,this.element,this.qb,!0),this.Db(),I(this.qb,!0),n=this.element,e=this.qb,n.hasAttribute("object-fit")&&U(e,"object-fit",n.getAttribute("object-fit")),n.hasAttribute("object-position")&&U(e,"object-position",n.getAttribute("object-position")),t.appendChild(this.qb);const s=t.getAttribute("artist"),r=t.getAttribute("title"),o=t.getAttribute("album"),c=t.getAttribute("artwork");if(this.Ey={"title":r||"","artist":s||"","album":o||"","artwork":[{"src":c||i||""}]},this.Fb=!!this.element.querySelector("source[data-bitrate]")||this.element.hasAttribute("cache")||this.Yb(),li(t),(a=t,lt(a,"video-manager")).register(this),this.element.hasAttribute("cache"))return this.Wb(),Mi(this.element,this.getAmpDoc(),this.Hb());var a}Nb(){const t=this.element.getAttribute("alt"),i=this.element.hasAttribute("title"),n=this.element.hasAttribute("aria-label");!t||i||n||this.element.setAttribute("aria-label",t)}detachedCallback(){this.Jb(!1)}Bb(){const{element:t}=this;(function(t){return!!function(t,i){return t.closest("amp-story")}(t)})(t)&&["i-amphtml-disable-mediasession","i-amphtml-poolbound"].forEach((i=>{t.classList.add(i)}))}mutatedAttributesCallback(t){if(!this.qb)return;const{element:i}=this;if(t.src&&(this.hv().assertHttpsUrl(i.getAttribute("src"),i),V(["src"],this.element,this.qb)),V(wi.filter((i=>void 0!==t[i])),this.element,this.qb,!0),t.src&&T(i,Zt),t.artwork||t.poster){const t=i.getAttribute("artwork"),n=i.getAttribute("poster");this.Ey.artwork=[{"src":t||n||""}]}if(t.album){const t=i.getAttribute("album");this.Ey.album=t||""}if(t.title){const t=i.getAttribute("title");this.Ey.title=t||""}if(t.artist){const t=i.getAttribute("artist");this.Ey.artist=t||""}}layoutCallback(){if(this.qb=this.qb,!this.Gb())return this.toggleFallback(!0),n();let t;V(Vi,this.element,this.qb,!0),this.Xb(),this.Zb((()=>this.Kb())),this.Qb(),"prerender"==this.getAmpDoc().getVisibilityState()||"preview"==this.getAmpDoc().getVisibilityState()?(this.element.hasAttribute("preload")||this.qb.setAttribute("preload","auto"),t=this.getAmpDoc().whenFirstVisible().then((()=>(this.vM(),It(this.win).promise(1).then((()=>{if(!this.PM())return this.loadPromise(this.qb)})))))):this.vM();const i=this.loadPromise(this.qb).then(null,(i=>{if(t)return t;throw i})).then((()=>this.bM()));return"none"!==this.element.getAttribute("preload")?this.PM()?t:i:void 0}yM(t){if(!this.qb.error||this.qb.error.code!=MediaError.MEDIA_ERR_DECODE)return;if(ot().error(Ri,`Decode error in ${this.qb.currentSrc}`,this.element),this.qb.src)return;let i=0;const n=g(this.qb,(t=>"SOURCE"==t.tagName&&(i++,t.src==this.qb.currentSrc)));0!=i&&(M(n),t.stopImmediatePropagation(),this.qb.load(),this.play(!1))}Wb(){this.EM().forEach((t=>{t.setAttribute("src",t.getAttribute("amp-orig-src")),t.removeAttribute("amp-orig-src")}))}Qb(){at(this.qb);const t=r(P(this.element,"source"));if(this.element.hasAttribute("src")&&Si(this.element)){const i=this.element.getAttribute("src"),n=this.element.getAttribute("type"),e=this.RM(i,n),s=this.element.getAttribute("amp-orig-src");e.setAttribute("amp-orig-src",s),this.element.removeAttribute("src"),this.element.removeAttribute("type"),t.unshift(e)}t.forEach((t=>{if(Si(t,this.element)){t.remove();const i=Object.keys(Ii),n=t.getAttribute("type"),e=t.getAttribute("amp-orig-src"),s=this.Hb();i.forEach(((r,o)=>{if(s<Ii[r])return;const c=bi(t.src,{"amp_video_quality":r}),a=this.RM(c,n,{"data-bitrate":Ii[r],"i-amphtml-video-cached-source":""});o===i.length-1&&a.setAttribute("amp-orig-src",e),this.qb.appendChild(a)}))}else t.hasAttribute("i-amphtml-video-cached-source")&&this.qb.appendChild(t)})),this.qb.changedSources&&this.qb.changedSources()}vM(){at(this.qb);const t=r(P(this.element,"source")),{element:i}=this,n=this.hv();i.hasAttribute("src")&&!Si(i)&&(n.assertHttpsUrl(i.getAttribute("src"),i),V(["src"],this.element,this.qb)),t.forEach((t=>{at(!Si(t,i)),n.assertHttpsUrl(t.getAttribute("src"),t),this.qb.appendChild(t)})),r(this.qb.querySelectorAll("[amp-orig-src]")).forEach((t=>{const i=t.getAttribute("amp-orig-src"),n=t.getAttribute("type"),e=this.RM(i,n);E(this.qb,e,t)})),r(P(i,"track")).forEach((t=>{this.qb.appendChild(t)})),this.TM(),this.qb.changedSources&&this.qb.changedSources()}RM(t,i,n={}){const{element:e}=this;this.hv().assertHttpsUrl(t,e);const s=e.ownerDocument.createElement("source");return s.setAttribute("src",t),i&&s.setAttribute("type",i),R(s,n),s}EM(){const{element:t}=this,i=r(P(t,"source")),n=[];i.push(t);for(let t=0;t<i.length;t++)Si(i[t])&&n.push(i[t]);return n}Yb(){return!!this.EM().length}Hb(){return this.PM()&&Pt(this.win,"amp-story-first-page-max-bitrate")&&_(this.element,"amp-story-page:first-of-type amp-video")?(Rt(this.win).addEnabledExperiment("amp-story-first-page-max-bitrate"),1e3):Number.POSITIVE_INFINITY}Db(){const t=this.qb;t.addEventListener("error",(t=>this.yM(t))),this.__.push(this.forwardEvents([Jt,Dt,"loadeddata",Ht,Wt,Yt],t)),this.__.push(xt(t,"volumechange",(()=>{const{muted:t}=this.qb;this.B!=t&&(this.B=t,T(this.element,this.B?Gt:Xt))}))),["play","pause","ended"].forEach((i=>{this.__.push(xt(t,i,(()=>this.Jb("play"==i))))}))}IM(){for(this.Jb(!1);this.__.length;)this.__.pop().call()}resetOnDomChange(){var t,i;this.qb=(i=this.element,v("video"),"> video",i.querySelector(m("> video",":scope"))),this.IM(),this.Db(),this.Fb&&(t=this.win,di||(Pt(t,"flexible-bitrate")&&Rt(t).addEnabledExperiment("flexible-bitrate"),di=new class{constructor(t){this.win=t,this.VM="",this.wM=this.kM(),this.SM=[]}manage(t){Pt(this.win,"flexible-bitrate")&&(t.changedSources||(function(t,i){xt(t,"waiting",(()=>{if(t.readyState<1||_i(t)>.99)return;let n=null;const e=jt(t,"playing",(()=>{clearTimeout(n)}));n=setTimeout((()=>{e(),i()}),100)}))}(t,(()=>this.CM(t))),xt(t,"downgrade",(()=>this.CM(t))),t.changedSources=()=>{this.OM(t)},this.SM.push(fi.make(this.win,t))))}CM(t){const i=function(t){return at(vi(t,(i=>i.src==t.currentSrc)))}(t),n=i.xM-1;n>=this.wM||(this.wM=n,this.jM(t,i.xM),this.qM())}$M(){const{connection:t}=this.win.navigator;return t&&t.effectiveType?t.effectiveType:"4g"}kM(){return this.VM!=this.$M()&&(this.VM=this.$M(),this.wM=pi[this.VM]||pi["4g"]),this.wM}OM(t){const i=r(P(t,"source"));i.forEach((t=>{if(t.xM)return;const i=t.getAttribute("data-bitrate");t.xM=i?parseInt(i,10):Number.POSITIVE_INFINITY}));let n=!1;return i.sort(((t,i)=>{const e=this.FM(i)-this.FM(t);return e<0&&(n=!0),e})),n&&i.forEach((i=>{t.appendChild(i)})),n}FM(t){let i=t.xM;return i>this.kM()&&(i*=-1),i}LM(t,i){return!!vi(t,(t=>t.xM<i))}jM(t,i){if(!this.LM(t,i))return;const{currentTime:n}=t;t.pause(),this.OM(t)?(t.load(),jt(t,"loadedmetadata",(()=>{t.currentTime=n,Y(t)}))):Y(t)}qM(){for(let i=this.SM.length-1;i>=0;i--){const n=this.SM[i].deref();n?n.paused&&!((t=n).hasAttribute(mi)?"true"===t.getAttribute(mi):_i(t)>.8)&&this.OM(n)&&n.load():this.SM.splice(i,1)}var t}}(t))).manage(this.qb),this.qb.readyState>=1?this.bM():(function(t,i,n,e){let s;const r=new Promise((i=>{s=jt(t,"loadedmetadata",i,void 0)}));return r.then(s,s),r}(this.qb).then((()=>this.bM())),this.TM())}TM(){const t=this.element.getAttribute("captions-id");if(!t)return;const i=this.win.document.querySelector(`amp-story-captions#${n=t,CSS.escape(n)}`);var n;if(!i)return;const e=this.getAmpDoc();Et(e.win).installExtensionForDoc(e,"amp-story-captions","0.1"),this.Lb=!0,i.getImpl().then((t=>{t.setVideoElement&&t.setVideoElement(this.qb)}))}bM(){T(this.element,Nt),this.zM()}pauseCallback(){this.qb&&this.qb.pause()}Jb(t){this.PM()||this.kv.updatePlaying(t)}Gb(){return!!this.qb.play}supportsPlatform(){return this.Gb()}isInteractive(){return this.element.hasAttribute("controls")}play(t){Y(this.qb)}Xb(){if(!Tt(this.win).isAndroid())return;const{element:t}=this;if(t.querySelector("i-amphtml-poster"))return;const i=t.getAttribute("poster");if(!i)return;const n=w(t)(Ei);!function(t,i){const{style:n}=t;d(!0),d(!n.display),n.display="block"}(n),B(n,{"background-image":`url(${i})`,"background-size":"cover","background-position":"center"}),n.classList.add("i-amphtml-android-poster-bug"),I(n),t.appendChild(n)}pause(){this.qb.pause()}mute(){this.PM()||(this.qb.muted=!0)}unmute(){this.PM()||(this.qb.muted=!1)}PM(){return this.element.classList.contains("i-amphtml-poolbound")}showControls(){this.qb.controls=!0}hideControls(){this.qb.controls=!1}fullscreenEnter(){!function(t){const i=t.requestFullscreen||t.requestFullScreen||t.webkitRequestFullscreen||t.webkitEnterFullscreen||t.msRequestFullscreen||t.mozRequestFullScreen;i&&i.call(t)}(this.qb)}fullscreenExit(){!function(t){const i=t.cancelFullScreen||t.exitFullscreen||t.webkitExitFullscreen||t.webkitCancelFullScreen||t.mozCancelFullScreen||t.msExitFullscreen;if(i)return void i.call(t);const{ownerDocument:n}=t;if(!n)return;const e=n.cancelFullScreen||n.exitFullscreen||n.webkitExitFullscreen||n.webkitCancelFullScreen||n.mozCancelFullScreen||n.msExitFullscreen;e&&e.call(n)}(this.qb)}isFullscreen(){return function(t){const{webkitDisplayingFullscreen:i}=t;if(void 0!==i)return i;const{ownerDocument:n}=t;return!!n&&(n.fullscreenElement||n.webkitFullscreenElement||n.mozFullScreenElement||n.webkitCurrentFullScreenElement)==t}(this.qb)}getMetadata(){return this.Ey}preimplementsMediaSessionAPI(){return!1}preimplementsAutoFullscreen(){return!1}getCurrentTime(){return this.qb.currentTime}getDuration(){return this.qb.duration}getPlayedRanges(){const{played:t}=this.qb,{length:i}=t,n=[];for(let e=0;e<i;e++)n.push([t.start(e),t.end(e)]);return n}firstLayoutCompleted(){this.Kb()||this.togglePlaceholder(!1)}zM(){const t=this.element.querySelector("i-amphtml-poster");t&&M(t)}hv(){return Vt(this.element)}Kb(){const t=this.getPlaceholder();return!(!t||!t.classList.contains("i-amphtml-blurry-placeholder")||(function(t,i){const{style:n}=t;for(const t in i)n.setProperty(L(z(n,t)),String(i[t]),"important")}(t,{"opacity":0}),0))}Zb(t){const i=this.qb.getAttribute("poster");if(i){const n=new Image;n.onload=t,n.src=i}}seekTo(t){this.qb.currentTime=t}toggleCaptions(t){r(this.qb.textTracks).forEach((i=>{i.mode=t?this.Lb?"hidden":"showing":"disabled"}))}};function Si(t,i){const n=t.getAttribute("src");return!!t.hasAttribute("amp-orig-src")&&Vt(i||t).isProxyOrigin(n)}t.registerElement(Ri,ki)})();
/*! https://mths.be/cssescape v1.5.1 by @mathias | MIT license */}});
//# sourceMappingURL=amp-video-0.1.mjs.map